# üåê –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–º–µ–Ω–µ –¥–æ–º–µ–Ω–∞

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–ß—Ç–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ –∫–æ–¥–µ](#—á—Ç–æ-–Ω—É–∂–Ω–æ-–∏–∑–º–µ–Ω–∏—Ç—å-–≤-–∫–æ–¥–µ)
2. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS –∏ SSL](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-dns-–∏-ssl)
3. [–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π](#–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ-–∫–æ–Ω—Ñ–∏–≥–æ–≤-—É-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
4. [–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è](#–ø–æ—à–∞–≥–æ–≤–∞—è-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è)

---

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ –∫–æ–¥–µ

### 1. **–§–∞–π–ª `.env` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**

–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ–º–µ–Ω–∞ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
# API –ø–∞–Ω–µ–ª–∏ Remnawave (–ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è + –Ω–æ–¥—ã)
API_BASE_URL=https://panel.NEW-DOMAIN.com

# Mini App –¥–æ–º–µ–Ω (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –º–µ–Ω—è—Ç—å, –µ—Å–ª–∏ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –Ω–∞ app.shftsecure.one)
# –≠—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é, –Ω–æ –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –¥–ª—è webhook URLs
```

**–ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è:** `/opt/shftsecurebot/.env`

---

### 2. **Caddy –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**

Caddy –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç Mini App –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã.

**–§–∞–π–ª:** `caddy/Caddyfile`

–¢–µ–∫—É—â–∏–π –¥–æ–º–µ–Ω:
```caddyfile
app.shftsecure.one {
    # ... –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
}
```

–ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω–æ–≤—ã–π:
```caddyfile
app.NEW-DOMAIN.com {
    # ... –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
}
```

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:** `/opt/caddy/Caddyfile`

---

### 3. **YooKassa Return URL** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ YooKassa –¥–ª—è –ø—Ä–∏–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π, –æ–±–Ω–æ–≤–∏—Ç–µ return URL:

```bash
# –í —Ñ–∞–π–ª–µ .env
YOOKASSA_RETURN_URL=https://t.me/YOUR_BOT_USERNAME
```

–≠—Ç–æ —Å—Å—ã–ª–∫–∞, –∫—É–¥–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã. –û–±—ã—á–Ω–æ —ç—Ç–æ –±–æ—Ç, –∞ –Ω–µ —Å–∞–π—Ç.

---

## üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS –∏ SSL

### 1. **DNS –∑–∞–ø–∏—Å–∏**

–°–æ–∑–¥–∞–π—Ç–µ **A-–∑–∞–ø–∏—Å—å** –¥–ª—è –Ω–æ–≤–æ–≥–æ –¥–æ–º–µ–Ω–∞:

```
–¢–∏–ø: A
–ò–º—è: app.NEW-DOMAIN.com (–∏–ª–∏ –ø—Ä–æ—Å—Ç–æ app)
–ó–Ω–∞—á–µ–Ω–∏–µ: IP_–ê–î–†–ï–°_–°–ï–†–í–ï–†–ê
TTL: 300 (5 –º–∏–Ω—É—Ç)
```

–ï—Å–ª–∏ Mini App –±—É–¥–µ—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ–¥–¥–æ–º–µ–Ω–µ:
```
app.NEW-DOMAIN.com ‚Üí IP_–ê–î–†–ï–°_–°–ï–†–í–ï–†–ê
```

### 2. **SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç**

**Caddy –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∏—Ç SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ –∫ –Ω–æ–≤–æ–º—É –¥–æ–º–µ–Ω—É! ‚úÖ

–ü—Ä–æ—Å—Ç–æ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
- DNS –∑–∞–ø–∏—Å—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- –ü–æ—Ä—Ç—ã **80** –∏ **443** –æ—Ç–∫—Ä—ã—Ç—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –î–æ–º–µ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞

**–ü—Ä–æ–≤–µ—Ä–∫–∞ SSL:**
```bash
curl -I https://app.NEW-DOMAIN.com
```

–ï—Å–ª–∏ –≤—Å—ë –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã —É–≤–∏–¥–∏—Ç–µ `HTTP/2 200` —Å –≤–∞–ª–∏–¥–Ω—ã–º SSL.

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### ‚ùì –ü—Ä–æ–±–ª–µ–º–∞

–ö–æ–≥–¥–∞ –≤—ã –º–µ–Ω—è–µ—Ç–µ –¥–æ–º–µ–Ω –ø–∞–Ω–µ–ª–∏ Remnawave (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å `panel.old-domain.com` –Ω–∞ `panel.new-domain.com`):

- **–ö–æ–Ω—Ñ–∏–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** —Å–æ–¥–µ—Ä–∂–∞—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —Å—Ç–∞—Ä—ã–π –¥–æ–º–µ–Ω
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ **–Ω–µ —Å–º–æ–≥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å –∫–æ–Ω—Ñ–∏–≥–∏** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ü–æ–¥–ø–∏—Å–∫–∏ —Å—Ç–∞–Ω—É—Ç **–Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã**

### ‚úÖ –†–µ—à–µ–Ω–∏–µ 1: –ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Remnawave API

Remnawave API **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç `subscriptionUrl`** –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–∞–Ω–µ–ª–∏.

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**

1. **–û–±–Ω–æ–≤–∏—Ç–µ –¥–æ–º–µ–Ω –≤ –ø–∞–Ω–µ–ª–∏ Remnawave:**
   - –ó–∞–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞–Ω–µ–ª–∏
   - –£–∫–∞–∂–∏—Ç–µ –Ω–æ–≤—ã–π –¥–æ–º–µ–Ω –¥–ª—è –ø–æ–¥–ø–∏—Å–æ–∫
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

2. **–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∏—Ç –Ω–æ–≤—ã–µ —Å—Å—ã–ª–∫–∏:**
   - –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—Ä–æ—Å–µ `/api/users/{uuid}` API –≤–µ—Ä–Ω—ë—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π `subscriptionUrl`
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥ —á–µ—Ä–µ–∑ –±–æ—Ç–∞

**–ü—Ä–∏–º–µ—Ä API –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl -X GET "https://panel.NEW-DOMAIN.com/api/users/USER_UUID" \
  -H "Authorization: Bearer YOUR_API_TOKEN"
```

–û—Ç–≤–µ—Ç –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π `subscriptionUrl`:
```json
{
  "uuid": "...",
  "username": "user123",
  "subscriptionUrl": "https://panel.NEW-DOMAIN.com/api/sub/SHORT_UUID"
}
```

---

### ‚úÖ –†–µ—à–µ–Ω–∏–µ 2: –†–µ–¥–∏—Ä–µ–∫—Ç —Å–æ —Å—Ç–∞—Ä–æ–≥–æ –¥–æ–º–µ–Ω–∞ –Ω–∞ –Ω–æ–≤—ã–π

–ï—Å–ª–∏ —É –≤–∞—Å –≤—Å—ë –µ—â—ë –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å—Ç–∞—Ä–æ–º—É –¥–æ–º–µ–Ω—É:

**–ù–∞ —Å—Ç–∞—Ä–æ–º —Å–µ—Ä–≤–µ—Ä–µ** (–µ—Å–ª–∏ —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä):
```caddyfile
old-panel.OLD-DOMAIN.com {
    redir https://panel.NEW-DOMAIN.com{uri} permanent
}
```

**–ù–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ** (–¥–æ–±–∞–≤—å—Ç–µ –≤ Caddyfile):
```caddyfile
panel.OLD-DOMAIN.com {
    redir https://panel.NEW-DOMAIN.com{uri} permanent
}
```

–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –Ω–æ–≤—ã–π –¥–æ–º–µ–Ω –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞.

---

### ‚úÖ –†–µ—à–µ–Ω–∏–µ 3: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–û—Ç–ø—Ä–∞–≤—å—Ç–µ –º–∞—Å—Å–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤—Å–µ–º –∞–∫—Ç–∏–≤–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º:

**–°–æ–∑–¥–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –¥–ª—è –∞–¥–º–∏–Ω–∞:**
```python
# src/handlers/admin.py

@router.message(Command("notify_domain_change"))
async def notify_domain_change(message: Message):
    """–£–≤–µ–¥–æ–º–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ —Å–º–µ–Ω–µ –¥–æ–º–µ–Ω–∞."""
    if message.from_user.id not in get_settings().admins:
        return
    
    # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–æ–π
    conn = get_db_connection()
    cursor = conn.cursor()
    cursor.execute("SELECT telegram_id FROM bot_users WHERE remnawave_uuid IS NOT NULL")
    users = cursor.fetchall()
    conn.close()
    
    notification_text = (
        "üîî <b>–í–∞–∂–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ!</b>\n\n"
        "–ù–∞—à –¥–æ–º–µ–Ω –∏–∑–º–µ–Ω–∏–ª—Å—è –Ω–∞ –Ω–æ–≤—ã–π –∞–¥—Ä–µ—Å.\n\n"
        "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ª—É—á–∏—Ç–µ <b>–Ω–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥</b> —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É /start ‚Üí –ú–æ–π –¥–æ—Å—Ç—É–ø ‚Üí –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥.\n\n"
        "–°—Ç–∞—Ä—ã–π –∫–æ–Ω—Ñ–∏–≥ –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞."
    )
    
    success = 0
    failed = 0
    
    for user_id, in users:
        try:
            await message.bot.send_message(user_id, notification_text, parse_mode="HTML")
            success += 1
        except Exception:
            failed += 1
    
    await message.reply(f"‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: {success}\n‚ùå –û—à–∏–±–∫–∏: {failed}")
```

---

## üìù –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

1. **–°–æ–∑–¥–∞–π—Ç–µ DNS-–∑–∞–ø–∏—Å—å** –¥–ª—è –Ω–æ–≤–æ–≥–æ –¥–æ–º–µ–Ω–∞ (A-–∑–∞–ø–∏—Å—å)
2. **–î–æ–∂–¥–∏—Ç–µ—Å—å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è DNS** (~5-30 –º–∏–Ω—É—Ç):
   ```bash
   nslookup app.NEW-DOMAIN.com
   ```

---

### –®–∞–≥ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞

**–ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ:**

1. –û–±–Ω–æ–≤–∏—Ç–µ `caddy/Caddyfile`:
   ```caddyfile
   app.NEW-DOMAIN.com {
       # –û—Å—Ç–∞–≤—å—Ç–µ –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ –∫–∞–∫ –µ—Å—Ç—å
   }
   ```

2. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
   ```bash
   git add caddy/Caddyfile
   git commit -m "Update domain to NEW-DOMAIN.com"
   git push
   ```

---

### –®–∞–≥ 3: –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

```bash
ssh root@SERVER_IP

# 1. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /opt/shftsecurebot

# 2. –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull

# 3. –û–±–Ω–æ–≤–ª—è–µ–º .env (–µ—Å–ª–∏ –º–µ–Ω—è–µ—Ç—Å—è –ø–∞–Ω–µ–ª—å Remnawave)
nano .env
# –ò–∑–º–µ–Ω–∏—Ç–µ API_BASE_URL –Ω–∞ –Ω–æ–≤—ã–π –¥–æ–º–µ–Ω –ø–∞–Ω–µ–ª–∏
# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: Ctrl+O, Enter, Ctrl+X

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
cd /opt/shftsecurebot
docker compose down
docker compose up -d --build

# 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º Caddy
cd /opt/caddy
docker compose down
docker compose up -d
```

---

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Mini App:**
   ```bash
   curl -I https://app.NEW-DOMAIN.com
   # –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å HTTP/2 200
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ API:**
   ```bash
   curl https://app.NEW-DOMAIN.com/api/profile \
     -H "X-Telegram-Init-Data: query_id=..."
   # –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å JSON —Å –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–æ—Ñ–∏–ª—è
   ```

3. **–û—Ç–∫—Ä–æ–π—Ç–µ Mini App –≤ Telegram:**
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
   - –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É Mini App
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å—ë –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤:**
   - –ú–æ–π –¥–æ—Å—Ç—É–ø ‚Üí –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥
   - –°—Å—ã–ª–∫–∞ –¥–æ–ª–∂–Ω–∞ –≤–µ—Å—Ç–∏ –Ω–∞ –Ω–æ–≤—ã–π –¥–æ–º–µ–Ω

---

### –®–∞–≥ 5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–í–∞—Ä–∏–∞–Ω—Ç A: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
- Remnawave API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω—ë—Ç –Ω–æ–≤—ã–µ —Å—Å—ã–ª–∫–∏ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—Ä–æ—Å–µ
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—Ç –Ω–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥ —á–µ—Ä–µ–∑ "–ú–æ–π –¥–æ—Å—Ç—É–ø"

**–í–∞—Ä–∏–∞–Ω—Ç B: –ú–∞—Å—Å–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/notify_domain_change` (—Å–º. –≤—ã—à–µ)
- –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—Å–µ–º –∞–∫—Ç–∏–≤–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

**–í–∞—Ä–∏–∞–Ω—Ç C: –†–µ–¥–∏—Ä–µ–∫—Ç**
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç —Å–æ —Å—Ç–∞—Ä–æ–≥–æ –¥–æ–º–µ–Ω–∞ (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### 1. **–ü–∞–Ω–µ–ª—å Remnawave ‚â† Mini App**
- **–ü–∞–Ω–µ–ª—å Remnawave** ‚Äî —ç—Ç–æ –≤–∞—à VPN-—Å–µ—Ä–≤–µ—Ä –∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- **Mini App** ‚Äî —ç—Ç–æ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–æ—Ç–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –û–Ω–∏ **–º–æ–≥—É—Ç** –±—ã—Ç—å –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –¥–æ–º–µ–Ω–∞—Ö!

### 2. **–ß—Ç–æ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
‚úÖ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (Caddy –ø–æ–ª—É—á–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚úÖ –°—Å—ã–ª–∫–∏ –Ω–∞ –∫–æ–Ω—Ñ–∏–≥–∏ (API –≤–µ—Ä–Ω—ë—Ç –Ω–æ–≤—ã–π `subscriptionUrl`)
‚úÖ –õ–æ–≥–∏ (Caddy —Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—ã–π —Ñ–∞–π–ª –ª–æ–≥–∞)

### 3. **–ß—Ç–æ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –≤—Ä—É—á–Ω—É—é:**
‚ùå DNS-–∑–∞–ø–∏—Å–∏
‚ùå `.env` (–µ—Å–ª–∏ –º–µ–Ω—è–µ—Ç—Å—è –ø–∞–Ω–µ–ª—å)
‚ùå `Caddyfile` (–µ—Å–ª–∏ –º–µ–Ω—è–µ—Ç—Å—è Mini App)
‚ùå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 4. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
- –°—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏ **–ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å**, –µ—Å–ª–∏:
  - –°—Ç–∞—Ä—ã–π –¥–æ–º–µ–Ω –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ –Ω–æ–≤—ã–π
  - –ü–∞–Ω–µ–ª—å Remnawave –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –æ–±–æ–∏–º –¥–æ–º–µ–Ω–∞–º
- –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã **–ø–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥**

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ DNS
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ A-–∑–∞–ø–∏—Å–∏
dig app.NEW-DOMAIN.com

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
ping app.NEW-DOMAIN.com
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ SSL
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
openssl s_client -connect app.NEW-DOMAIN.com:443 -servername app.NEW-DOMAIN.com

# –ö—Ä–∞—Ç–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
curl -I https://app.NEW-DOMAIN.com
```

### –õ–æ–≥–∏ Caddy
```bash
# –¢–µ–∫—É—â–∏–µ –ª–æ–≥–∏
docker logs caddy -f

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫ SSL
docker logs caddy 2>&1 | grep -i error
```

### –õ–æ–≥–∏ –±–æ—Ç–∞
```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏
docker logs shftsecurebot-bot-1 --tail 100

# –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫ API
docker logs shftsecurebot-bot-1 2>&1 | grep -i "api error"
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS:** `nslookup app.NEW-DOMAIN.com`
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Caddy:** `docker logs caddy`
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞:** `docker logs shftsecurebot-bot-1`
4. **–û—Ç–∫–∞—Ç–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
   ```bash
   git checkout HEAD~1 -- caddy/Caddyfile
   docker compose restart
   ```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ —Å–º–µ–Ω–æ–π –¥–æ–º–µ–Ω–∞

- [ ] DNS-–∑–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ü–æ—Ä—Ç—ã 80 –∏ 443 –æ—Ç–∫—Ä—ã—Ç—ã
- [ ] `.env` –æ–±–Ω–æ–≤–ª—ë–Ω (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- [ ] `Caddyfile` –æ–±–Ω–æ–≤–ª—ë–Ω
- [ ] –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –≤ Git
- [ ] –°–¥–µ–ª–∞–Ω –±—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –¥–æ—Å—Ç—É–ø –∫ Mini App
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ API

---

**–ì–æ—Ç–æ–≤–æ!** üéâ

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –≤–∞—à –±–æ—Ç –∏ Mini App –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –Ω–æ–≤–æ–º –¥–æ–º–µ–Ω–µ.

